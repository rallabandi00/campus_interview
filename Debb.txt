select  top 2 PRO_ID,PRO_CODE,PRO_LRH_NAME,PRO_LATITUDE,PRO_LONGTITUDE,CLN_ROU_DATE,CLN_ROU_TIME 
  from [LRH_CLEANER_PROPERTY_DETAILS] LRHCLEANR join [LRH_MST_PROPERTY] LRHPROPERTY on LRHCLEANR.CLN_PRO_ID=LRHPROPERTY.PRO_ID
  join [LRH_CLEANER_ROUTE_DETAILS] LRHCLEANERROUTEDETILS on LRHCLEANERROUTEDETILS.CLN_ROU_PRO_ID=LRHCLEANR.CLN_PRO_ID
  and LRHCLEANERROUTEDETILS.CLN_ROU_CLENER_ID=LRHCLEANR.CLN_CLENER_ID
  where CLN_STATUS=1 and CLN_CLENER_ID=3 AND   convert(varchar(10),CLN_ROU_DATE,101)=convert(varchar(10),getdate(),101)
  order by CLN_ROU_ID asc

  --with pivot
  select CLN_CLENER_ID,[YET TO CLEAN],[COMPLETED]
from(
select CLN_CLENER_ID,CLN_STATUS_NAME,CLN_STATUS_ID from LRH_CLEANING_STATUS LRHSTAtUS
left join  [LRH_CLEANER_PROPERTY_DETAILS] LRHCLEANR  ON LRHSTAtUS.CLN_STATUS_ID=LRHCLEANR.CLN_STATUS
left join [LRH_CLEANER_ROUTE_DETAILS] LRHCLEANERROUTEDETILS 
  on LRHCLEANERROUTEDETILS.CLN_ROU_PRO_ID=LRHCLEANR.CLN_PRO_ID
  and LRHCLEANERROUTEDETILS.CLN_ROU_CLENER_ID=LRHCLEANR.CLN_CLENER_ID
  and CLN_CLENER_ID=3
  and convert(varchar(10),CLN_ROU_DATE,101)=convert(varchar(10),getdate(),101))as source
  pivot
  (
  count(CLN_STATUS_NAME) for CLN_STATUS_NAME in ([YET TO CLEAN],[COMPLETED]) 
  ) as pivottable

  where CLN_CLENER_ID is not null
